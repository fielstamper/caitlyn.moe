<div id="aniList-grid"><slot /></div>

<script>
    fetch("https://graphql.anilist.co", {
        method: "POST",
        headers: { "content-type": "application/json" },
        body: JSON.stringify({
            query: `{
            Page(perPage: 50) {
                activities(userId: 7495217, type: MEDIA_LIST, sort: ID_DESC) {
                    ... on ListActivity {
                        media {
                            siteUrl
                            title { romaji }
                            coverImage { extraLarge }
                            type
                        }
                        status progress createdAt
                    }
                }
            }
        }`,
        }),
    })
        .then((response) => response.json())
        .then((jsonData) => {
            console.log(jsonData);
            const aniListGrid = document.getElementById("aniList-grid");
            const mangas = jsonData.data.Page.activities.slice(0, 5);

            for (const manga of mangas) {
                const mangaAnchor = document.createElement("a");
                mangaAnchor.classList.add("mangaAnchor");

                const mangaURL = document.createElement("p");
                mangaURL.textContent = manga.media.siteUrl;

                const mangaCover = document.createElement("img");
                mangaCover.src = manga.media.coverImage.extraLarge;
                mangaCover.classList.add("mangaCover");

                mangaAnchor.setAttribute("href", manga.media.siteUrl);
                mangaAnchor.classList.add("mangaText");

                const mangaStatus = document.createElement("span");
                mangaStatus.textContent = manga.status + " ";
                mangaStatus.classList.add("mangaText");

                const mangaChapter = document.createElement("span");
                mangaChapter.textContent = manga.progress;

                const mangaTitle = document.createElement("p");
                mangaTitle.textContent = manga.media.title.romaji;
                mangaTitle.classList.add("mangaTitle");

                mangaAnchor.append(
                    mangaCover,
                    mangaStatus,
                    mangaChapter,
                    mangaTitle,
                );
                aniListGrid.append(mangaAnchor);
            }
        });
</script>

<style is:global>
    #aniList-grid {
        display: flex;
        width: 50em;
        overflow: hidden;
        text-align: center;
        gap: 20px;
        justify-content: space-between;
    }

    @media (max-width: 768px) {
        #aniList-grid {
            overflow-x: scroll;
            width: 100%;
            padding-left: 10px;
        }
    }

    .mangaText {
        color: #dbdbdbcb;
        font-size: 16px;
        text-decoration: none;
    }

    .mangaAnchor {
        height: 100%;
        width: 125px;
    }

    .mangaTitle {
        color: #dbdbdb6e;
    }

    .mangaAnchor img {
        height: 202.249px;
        width: 125px;
        border-radius: 8px;
        transition: all 0.25s
            linear(
                0,
                0.0014 0.52%,
                0.0066 1.14%,
                0.0248 2.27%,
                0.0553 3.51%,
                0.1016 4.96%,
                0.1988 7.44%,
                0.4395 12.92%,
                0.5468 15.5%,
                0.6508 18.29%,
                0.7369 20.98%,
                0.8114,
                0.8711 26.56%,
                0.8967 28.01%,
                0.9204,
                0.9406,
                0.9576 32.66%,
                0.982 35.55%,
                0.9998 38.76%,
                1.0112 42.37%,
                1.0167 46.51%,
                1.0165 52.61%,
                1.0062 67.18%,
                1.0021 76.07%,
                0.9997 99.94%
            );
        opacity: 100%;
    }

    @media (max-width: 768px) {
        .mangaAnchor img {
            height: 161px;
            width: 100px;
        }
    }

    .mangaAnchor img:hover {
        background-color: rgba(12, 12, 12, 0.336);
        opacity: 50%;
    }
</style>
